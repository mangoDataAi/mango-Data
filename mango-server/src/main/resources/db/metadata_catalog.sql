-- 创建元数据目录表
CREATE TABLE IF NOT EXISTS METADATA_CATALOG (
  ID VARCHAR(36) NOT NULL COMMENT '目录节点ID，使用UUID',
  NAME VARCHAR(100) NOT NULL COMMENT '节点名称',
  TYPE VARCHAR(20) NOT NULL COMMENT '节点类型：datasource(数据源)、database(数据库)、table(表)、view(视图)',
  PARENT_ID VARCHAR(36) DEFAULT NULL COMMENT '父节点ID',
  DESCRIPTION VARCHAR(500) DEFAULT NULL COMMENT '节点描述',
  PATH VARCHAR(500) DEFAULT NULL COMMENT '节点路径',
  ORDER_NUM INT DEFAULT 1 COMMENT '排序号',
  CREATE_TIME TIMESTAMP NOT NULL COMMENT '创建时间',
  UPDATE_TIME TIMESTAMP NOT NULL COMMENT '更新时间',
  PRIMARY KEY (ID)
);

-- 创建索引
CREATE INDEX IDX_PARENT_ID ON METADATA_CATALOG (PARENT_ID);
CREATE INDEX IDX_TYPE ON METADATA_CATALOG (TYPE);

-- 插入初始数据
INSERT INTO METADATA_CATALOG (ID, NAME, TYPE, PARENT_ID, DESCRIPTION, PATH, ORDER_NUM, CREATE_TIME, UPDATE_TIME)
VALUES
  ('11111111-1111-1111-1111-111111111111', 'Delta Lake', 'datasource', NULL, 'Delta Lake数据源', '/Delta Lake', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
  ('22222222-2222-2222-2222-222222222222', 'StarRocks', 'datasource', NULL, 'StarRocks数据源', '/StarRocks', 2, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
  ('33333333-3333-3333-3333-333333333333', '用户域', 'database', '11111111-1111-1111-1111-111111111111', '用户相关数据', '/Delta Lake/用户域', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
  ('44444444-4444-4444-4444-444444444444', '交易域', 'database', '11111111-1111-1111-1111-111111111111', '交易相关数据', '/Delta Lake/交易域', 2, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
  ('55555555-5555-5555-5555-555555555555', '指标库', 'database', '22222222-2222-2222-2222-222222222222', '指标相关数据', '/StarRocks/指标库', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
  ('66666666-6666-6666-6666-666666666666', '用户画像数据集', 'table', '33333333-3333-3333-3333-333333333333', '用户画像基础数据', '/Delta Lake/用户域/用户画像数据集', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
  ('77777777-7777-7777-7777-777777777777', '交易指标分析', 'table', '55555555-5555-5555-5555-555555555555', '交易指标分析数据', '/StarRocks/指标库/交易指标分析', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP); 